# jira(1) completion

_jira_compgen_options()
{
    local options=(--help --action --file --debug --verbose --server --user --password password --login --service --loginFromStandardInput --project --toProject --name --description description --url --lead --after --issue --toIssue --parent --summary --priority priority --reporter --assignee --environment environment --components --affectsVersions --fixVersions --custom --field --date date --dateFormat --type --resolution --step --comment --filter --link --values --count --outputFormat --plugin plugin --version --role --group --defaultGroup --userId --userFullName userFullName --userEmail --userPassword --permissionScheme --notificationScheme notificationScheme --issueSecurityScheme --findReplace --autoVersion --autoComponent --autoGroup --asVersion --asComponent)

    COMPREPLY=( $(skeleton_compgen_word.pl -- "$( echo ${options[@]} )" "$cur") )
}

_jira_issue_types()
{
    local IFS=$'\t\n'
    local types=(
        Bug
        "New Feature"
        Task
        Improvement
        Epic
        Story
        "Test Task"
    )
    
    COMPREPLY=( $(skeleton_compgen_word.pl -d '\n' -- "$(for x in ${types[@]}; do echo $x; done)" "$cur") )
}

_jira_file_list()
{
    local IFS=$'\t\n'
    COMPREPLY=( $(skeleton_compgen_word.pl -d '\n' -- "$(cd "$1"; 'ls')" "$cur") )
}

_jira_actions()
{
        
    local actions=(login logout getServerInfo createProject deleteProject getProjectList addVersion addComponent deleteComponent copyComponents createIssue updateIssue linkIssue addComment addAttachment progressIssue getIssue getFieldValue setFieldValue getAvailableSteps getIssueList getCommentList getComments getAttachment getAttachmentList addUser addUserWithFile removeUser removeUserWithFile addGroup removeGroup addUserToGroup addUserToGroupWithFile removeUserFromGroup removeUserFromGroupWithFile getUserList getPluginList getPluginDownload)
    
    COMPREPLY=( $(skeleton_compgen_word.pl -- "$( echo ${actions[@]} )" "$cur") )
}

_jira()
{
    local cmd cur prev skinsdir IFS=$' \t\n' i j k=0

    COMPREPLY=()
    cmd=${COMP_WORDS[0]}
    _get_comp_words_by_ref cur prev

    case $prev in
        -a|--action)
            _jira_actions
            return 0
            ;;
        --issue)
            _jira_file_list ~/jira-issues/
            return 0
            ;;
        --project)
            _jira_file_list ~/jira-projects/
            return 0
            ;;
        --type)
            _jira_issue_types
            return 0
            ;;
    esac

    case $cur in
        -*)
            _jira_compgen_options
            return 0
            ;;
    esac

    return 0
}
complete -o filenames -F _jira jira jira-help.pl

# Local variables:
# mode: shell-script
# sh-basic-offset: 4
# sh-indent-comment: t
# indent-tabs-mode: nil
# End:
# ex: ts=4 sw=4 et filetype=sh
