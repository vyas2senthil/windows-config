#!/bin/bash

do_ask=false
args=()
for x in "$@"; do
    if test -e "$x" && test "$(fstype "$x")" = fuse.sshfs; then
        args=("${args[@]}" "$(get-scp-from-sshfs "$x"|perl -npe 's/^.*?://')")
        do_ask=true
    else
        args=("${args[@]}" "$x")
    fi
done

if test $do_ask = false || yes-or-no-p -y "Will execute rsync ${args[@]}"; then
    /usr/bin/rsync "${args[@]}"
fi
