#!/usr/bin/env perl

#system("rm Sources.bz2");
#system("wget http://mirrors.163.com/debian/dists/sid/main/source/Sources.bz2");
#http://cn.archive.ubuntu.com/ubuntu/dists/maverick/main/source/Sources.bz2
#perl -npe 's,http://mirrors.163.com/debian,http://cn.archive.ubuntu.com/ubuntu,'


open($file, "-|", "bzcat Sources*bz2*");

$package = $ARGV[0];
while (<$file>) {
  chomp;
    
  if (m/^Package: $package$/) {
    while (<$file>) {
      chomp;
      if (m/^Directory: (.*)$/) {
	$dir=$1;
      } elsif (m/^Files:$/) {
	while (<$file>) {
	  last if not m/^\s/;
	  chomp;
	  push @name, (split)[2];
	}
      } elsif (m/^\s*$/) {
	for $name (@name) {
	  $path = "http://mirrors.163.com/debian/$dir/$name\n";
	  print $path;
	}
	last;
      }
    }
  }
}
