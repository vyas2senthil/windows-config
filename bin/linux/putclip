#!/bin/sh
if test $# != 0; then
    exec <<EOF
$@
EOF
fi

if test "$IN_EMACS" = true; then
    rm-last-nl > /tmp/$$.putclip
    export FILE=/tmp/$$.putclip
    (
        emacsclient --eval "
(let ((default-directory \"/tmp/\"))
(view-file \"$FILE\")
(kill-new (filter-buffer-substring (point-min) (point-max)))
(View-quit))"
        rm $FILE
    ) >/dev/null 2>&1&
else 
    rm-last-nl|xclip -i -selection clipboard
    xclip -o -selection clipboard|xclip -i
fi
