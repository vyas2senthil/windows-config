#!/bin/bash
test $# = 0 && set -- ""
export android_dir=$(
    cd $(lookup_file .repo/..) >/dev/null 2>&1
    readlink -f .
)
if test $# = 1 -a -f "$1"; then
    set -- $(cat "$1")
fi

for x in "$@"; do 
    rfa $x '
if git status -s |grep -q . || test $(git log -1 --pretty=oneline|pn 1) != $REPO_LREV; then
    relative-path $(readlink -f .) $android_dir/;
    echo;
fi'

done 2>&1 | (
    cd $(lookup_file .repo/..);
    log=./out/repo-changes.log"$(echo -n $*)"
    lognow="$log-$(now)"
    tee "$lognow" 2>/dev/null
    ln -sf $(basename "$lognow") "$log" >/dev/null 2>&1
)
