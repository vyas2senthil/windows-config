#!/bin/bash

unset dswSlnFile
for x in *.sln *.dsw ../*.sln ../*.dsw ../../*.sln ../../*.dsw ../../../*.sln ../../../*.dsw; do 
    if [[ -f "$x" ]]; then
        dswSlnFile="$x"
        break
    fi
done

if [[ -z $dswSlnFile ]]; then
    echo "Error: no project file (*.sln|*.dsw) found anywhere!"
    exit -1
fi

cd "`dirname \"$dswSlnFile\"`"
dswSlnFile="`basename \"$dswSlnFile\"`"



case $dswSlnFile in 
    *.dsw)
        vc6compile.py $dswSlnFile "$@" || exit
        ;;
    *.sln)
        if grep "Format Version 9.00" $dswSlnFile;
        then
            vc8compile.py $dswSlnFile "$@" || exit
        else
            vc7compile "$@"
        fi
        ;;
esac 
