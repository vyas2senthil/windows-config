#!/usr/bin/env perl

#system("rm Sources.bz2");
#system("wget http://mirrors.163.com/debian/dists/sid/main/source/Sources.bz2");
#http://cn.archive.ubuntu.com/ubuntu/dists/maverick/main/source/Sources.bz2
#perl -npe 's,http://mirrors.163.com/debian,http://cn.archive.ubuntu.com/ubuntu,'



for (@ARGV) {
  $pkgs{$_} = 1;
}

@ARGV = ();

while (<>) {
  chomp;
  if (m/^Package: (.*)$/) {
    next if not $pkgs{$1};

    while (<>) {
      chomp;
      if (m/^Filename: (.*)$/) {
	$path = "mirrors.163.com/debian/$1";
      } elsif (m/^Size: (.*)$/) {
	if (-s $path != $1) {
	  print "http://$path\n";
	}
	last;
      }
    }
  }
}
